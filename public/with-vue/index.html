<html>
<head>
	<title>Cashflow with Bootstrap and Vue</title>

	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<script src="bower_components/vue/dist/vue.min.js"></script>
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="bower_components/jquery-ui/jquery-ui.min.js"></script>
	<script src="bower_components/d3/d3.min.js"></script>
	<script src="bower_components/rickshaw/rickshaw.min.js"></script>
	<script src="bower_components/chart.js/dist/Chart.js"></script>
	<script src="bower_components/cryptojslib/rollups/md5.js"></script>
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/bootstrap3-dialog/dist/js/bootstrap-dialog.js"></script>
    <script src="bower_components/bootstrap-toggle/js/bootstrap2-toggle.min.js"></script>
	<link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="bower_components/jquery-ui/themes/smoothness/jquery-ui.min.css" rel="stylesheet">
	<link href="bower_components/rickshaw/rickshaw.min.css" rel="stylesheet">
	<link href="bower_components/bootstrap3-dialog/dist/css/bootstrap-dialog.min.css" rel="stylesheet">
	<link href="bower_components/bootstrap-toggle/css/bootstrap2-toggle.min.css" rel="stylesheet">

	<link href="css/dashboard.css" rel="stylesheet">
	<script src="js/utils.js"></script>
	<script src="js/navigation.js"></script>
	<script src="js/expenses-page.js"></script>
	<script src="js/recorded-expenses-page.js"></script>
	<script src="js/expected-expenses-page.js"></script>
	<script src="../resources/js/model/ExpenseItem.js"></script>
	<script src="../resources/js/model/OtpExpenseContentConfiguration.js"></script>
    <script src="../resources/js/model/RaiffeisenExpenseContentConfiguration.js"></script>
	<script src="../resources/js/controller/ExpenseParser.js"></script>
</head>
<body>
	<div id="app">
		<nav class="navbar navbar-inverse navbar-fixed-top">
	      <div class="container-fluid">
	        <div class="navbar-header">
	          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
	            <span class="sr-only">Toggle navigation</span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	            <span class="icon-bar"></span>
	          </button>
	          <a class="navbar-brand" href="#">Cashflow</a>
	        </div>
	        <div id="navbar" class="navbar-collapse collapse">
	          <ul class="nav navbar-nav navbar-right">
	            <li><a href="#">Dashboard</a></li>
	            <li><a href="#">Settings</a></li>
	            <li><a href="#">Profile</a></li>
	            <li><a href="#">Help</a></li>
	          </ul>
	          <form class="navbar-form navbar-right">
	            <input type="text" class="form-control" placeholder="Search...">
	          </form>
	        </div>
	      </div>
	    </nav>

	    <div class="container-fluid">
	      <div class="row">
	        <div class="col-sm-3 col-md-2 sidebar">

	          <ul class="nav nav-sidebar">
	            <li v-bind:class="{ active: navigation.currentPage == Navigation.ExpensesPage }"><a href="#" v-on:click="changePage(Navigation.ExpensesPage)">Summary</a></li>
	            <li v-bind:class="{ active: navigation.currentPage == Navigation.RecordedExpensesPage }">
	            	<a href="#" v-on:click="changePage(Navigation.RecordedExpensesPage)">Recorded Expenses</a>
	            </li>
	            <li v-bind:class="{ active: navigation.currentPage == Navigation.TagsPage }"><a href="#" v-on:click="changePage(Navigation.TagsPage)">Tags</a></li>
	            <li v-bind:class="{ active: navigation.currentPage == Navigation.UpcomingExpensesPage }"><a href="#" v-on:click="changePage(Navigation.UpcomingExpensesPage)">Upcoming Expenses</a></li>
	          </ul>
	        </div>

        
			<div v-show="navigation.currentPage == Navigation.ExpensesPage || navigation.currentPage == Navigation.RecordedExpensesPage" class="panel panel-default" style="position: relative; left: 350px; top: 20px; width: 1200px;">
			  	<div class="cashflow-panel">
				  	<span>Start Date: </span>
				  	<input type="text" id="startDate" class="cashflow-date-picker">

				  	<span>End Date: </span>
				  	<input type="text" id="endDate" class="cashflow-date-picker">

				  	<button class="btn btn-default btn-sm" v-on:click="refresh">Refresh</button>
				 </div>
	        </div>
	        

	        <div v-show="navigation.currentPage == Navigation.ExpensesPage" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
	          
	          <table width="1200">
	          	<tr>
	          		<td><h3>Burndown chart</h3></td>
	          		<td align="right">
	          			<input style="height: 80px;" data-toggle="toggle" type="checkbox" checked="checked" name="selectedAccountMain" id="selectedAccount_Main" />
	          			&nbsp;<span style="font-size: 9pt; font-family: Consolas">Main</span>
	          			&nbsp;&nbsp;&nbsp;<input data-toggle="toggle" checked="checked" type="checkbox" name="selectedAccountSavings" id="selectedAccount_Savings" />
	          			&nbsp;<span style="font-size: 9pt; font-family: Consolas">Savings</span>
	          		</td>
	          	</tr>
	          </table>

	          <div>
		          <div id="y_axis" style="position: absolute; top: 0; bottom: 0; width: 40px;"></div>
		          <div id="chart" style="position: relative; left: 5px; width: 635px; height: 280px;"></div>
	      	  </div>
	      	  <div>
	      	  	  <div class="cashflow-pie-chart cashflow-float-left">
	      	  	  	<h3>Distribution</h3>
	      	  	  	<canvas id="expenseDistributionPieChart"></canvas>
	      	  	  </div>

	      	  	  <div class="cashflow-bar-chart cashflow-float-left cashflow-left-padding-80">
	      	  	  	<h3>Amount Spent</h3>
	      	  	  	<canvas id="expenseDistributionBarChart"></canvas>
	      	  	  </div>
	      	  </div>

	        </div>

	        <div v-show="navigation.currentPage == Navigation.RecordedExpensesPage" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

	        	<button class="btn btn-primary btn-sm" v-on:click="showRecordExpensesFromBank">Upload Expenses</button>
	        	<button class="btn btn-success btn-sm" v-on:click="showRecordSavingsModal">Record Savings</button>
	        	<br/><br/>

	        	<div class="cashflow-float-left" style="text-align: right; font-family: Consolas; font-size: 8pt; width: 1200px;" v-if="recordedExpenses != null">Fetched {{recordedExpenses.length}} transactions</div>
	        	<br/>
		        <div class="container" style="width: 1200px;">
				  <table class="cashflow-recorded-expenses-table" style="width: 100%;">
				    <tbody>
				        <tr v-bind:class="[Utils.getBackgroundClassForAmount(entry.expense_value)]" v-for="entry in recordedExpenses" style="border-top: dotted 1px #dddddd; margin-bottom: 5px;" height="70">
				        	<td>
				        		<table width="100%">
				        			<tr>
				        				<td width="30%"><span v-bind:class="[Utils.getClassForAmount(entry.expense_value)]" style="font-weight: bold; font-size: 12pt;">{{Utils.formatAmount(entry.expense_value)}}</span></td>
				        				<td width="30%">
				        					<select 
				        						v-model="entry.tag" 
				        						v-bind:data-transaction-id="entry.transactionId"
				        						onChange="RecordedExpensesPage.setTag(this)">
				        						<option 
				        							v-for="entry in tags"
				        							v-bind:value="entry.label">{{entry.label}}</option>
				        					</select>
				        				</td>
				        				<td style="float: right">{{entry.expense_date}}</td>
				        			</tr>
				        			<tr>
				        				<td colspan="3">
				        					<span style="font-family: Consolas; font-size: 8pt;">{{entry.type}}</span><br/>
				        					<span style="font-family: Consolas; font-size: 8pt;">{{entry.location}}</span>
				        				</td>
				        			</tr>
				        		</table>
				        	</td>
				        </tr>
				    </tbody>
				  </table>
				</div>

	        </div>

			<div v-show="navigation.currentPage == Navigation.TagsPage" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
	          <h1 class="page-header">Tags</h1>

	        </div>

	        <div v-show="navigation.currentPage == Navigation.UpcomingExpensesPage" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
	          
	        	<table width="1200">
	        		<thead>
	        			<tr>
	        				<th>
	        					<button v-on:click="upcomingExpensesMoveDateRange(-30)" type="button" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span></button><br/>
	        					<button v-on:click="upcomingExpensesMoveDateRange(30)" type="button" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-arrow-down" aria-hidden="true">
	        				</th>
	        				<th class="cashflow-upcoming-expense-header">Effective Date</th>
	        				<th class="cashflow-upcoming-expense-header" 
	        					v-for="type in upcomingExpenseTypes">{{type.name}} <button v-on:click="showAddUpcomingExpenseModal(type.id)" class="btn btn-default btn-xs">new</button></th>
	        			</tr>
	        		</thead>
	        		<tbody>
	        			<tr v-for="entry in upcomingExpenses" class="cashflow-upcoming-expense-row">
	        				<td>&nbsp;</td>
	        				<td class="cashflow-upcoming-expense-cell">{{entry.effective_date}}<br/><span class="cashflow-float-right">{{entry.total_amount}} Ft</span></td>
	        				<td class="cashflow-upcoming-expense-cell" v-for="type in upcomingExpenseTypes">
	        					<span 
	        						data-toggle="tooltip" 
	        						v-bind:title="Utils.formatAmount(item.amount) + ' Ft'"
	        						v-bind:class="[Utils.getClassForUpcomingExpenseItem(item)]" 
	        						v-on:click="showUpcomingExpenseModificationPopup(item)"
	        						v-for="item in entry['expected_id_'+type.id]">{{item.name}}</span>

	        				</td>
	        			</tr>
	        		</tbody>
	        	</table>


	        </div>

	      </div>
	    </div>

	    <!-- Modals -->

		<div class="modal fade" id="recordSavingModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">Record Savings</h4>
		      </div>
		      <div class="modal-body">
		        <table width="100%" class="cashflow-table">
		        	<tr>
		        		<td width="200">Savings transferred at: </td>
		        		<td><input type="text" id="savingsTransferredDate" class="cashflow-date-picker"></td>
		        	</tr>
		        	<tr>
		        		<td>Amount: </td>
		        		<td><input type="text" id="savingsAmount" onKeyUp="RecordedExpensesPage.savingsAmountKeyUp()"></td>
		        	</tr>
		        	<tr>
		        		<td>Comment: </td>
		        		<td><input type="text" id="savingsComment"></td>
		        	</tr>
		        </table>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="button" class="btn btn-primary" v-on:click="recordSavings">Save</button>
		      </div>
		    </div>
		  </div>
		</div>

		<div class="modal fade" id="recordExpensesFromBankModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">Record Expenses from Bank</h4>
		      </div>
		      <div class="modal-body">

		      	<div class="cashflow-div-maxwidth">
		      		<div class="cashflow-float-left" style="width: 30%">
						<input type="radio" checked="checked" name="bankName" id="otp" value="otp" /> <label for="otp"><img src="images/otp.png" /> OTP Bank</label><br/>
	      				<input type="radio" name="bankName" id="raiffeisen" value="raiffeisen" /> <label for="raiffeisen"><img src="images/raiffeisen.ico" /> Raiffeisen</label>
		      		</div>
	      			<div class="cashflow-float-left" style="width: 70%;">
	      				<i style="font-size: 8pt;">paste csv content here:</i>
	      				<textarea id="importedCsvContent" style="width: 100%; height: 60px;"></textarea>
	      			</div>
	      		</div>
	      		<br/>

				<div class="modal-header" style="width: 570px; overflow-y: scroll; height: 400px;">
			        <table class="cashflow-table" style="width: 100%; sfont-size: 7pt;">
			        	<tr v-for="entry in expensesFromBank">
			        		<td style="width: 120px; font-size: 8pt; font-family: Consolas;">{{entry.Date.Display}}</td>
			        		<td style="font-size: 8pt; font-family: Consolas;">{{entry.Title}}</td>
			        		<td style="font-size: 8pt; font-family: Consolas;">{{entry.Amount.Display}}</td>
			        		<td style="font-size: 8pt; font-family: Consolas;">{{entry.Location}}</td>
			        	</tr>
			        </table>
		    	</div>
		    	<br/>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="button" class="btn btn-primary" v-on:click="storeExpenses">Store</button>
		      </div>
		    </div>
		  </div>
		</div>

		<div class="modal fade" id="modifyUpcomingExpense" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">Modify Upcoming Expense</h4>
		      </div>
		      <div class="modal-body">	

		      	<table class="cashflow-table" width="70%">
		      		<tr>
		      			<td>Name: </td>
		      			<td>{{selectedUpcomingExpense.name}}</td>
		      		</tr>
		      		<tr>
		      			<td>Effective Date: </td>
		      			<td>{{Utils.formatDate(selectedUpcomingExpense.effective_date)}}</td>
		      		</tr>
		      		<tr>
		      			<td>Amount: </td>
		      			<td>{{Utils.formatAmount(selectedUpcomingExpense.amount)}} Ft</td>
		      		</tr>
		      	</table>

		      </div>
		      <div class="modal-footer">
		      	<div class="cashflow-float-left" style="width: 40%; text-align: left;">
		      		<button class="btn btn-success" v-on:click="setPaid(selectedUpcomingExpense.id, 1)">Paid</button>
		      		<button class="btn btn-default" v-on:click="setPaid(selectedUpcomingExpense.id, 0)">Non-paid</button>
		      		<button class="btn btn-danger" v-on:click="deleteUpcomingExpense(selectedUpcomingExpense.id)">Delete</button>
		      	</div>
		      	<div class="cashflow-float-right">
		        	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		    	</div>
		      </div>
		    </div>
		  </div>
		</div>

		<div class="modal fade" id="addUpcomingExpenseModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">New Upcoming Expense</h4>
		      </div>
		      <div class="modal-body">	

		      	<table class="cashflow-table" width="70%">
		      		<tr>
		      			<td>Type: </td>
		      			<td>{{newUpcomingExpenseType}}</td>
		      		</tr>
		      		<tr>
		      			<td>Name: </td>
		      			<td><input type="text" id="upcomingExpenseName" /></td>
		      		</tr>
		      		<tr>
		      			<td>Effective Date: </td>
		      			<td><input type="text" id="upcomingExpenseDate" /></td>
		      		</tr>
		      		<tr>
		      			<td>Amount: </td>
		      			<td><input type="text" id="upcomingExpenseAmount" /></td>
		      		</tr>
		      	</table>

		      </div>
		      <div class="modal-footer">
		      	<button type="button" class="btn btn-primary" v-on:click="saveUpcomingExpense">Save</button>
	        	<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>		    	
		      </div>
		    </div>
		  </div>
		</div>

	</div>


    <!-- Bootstrap core JavaScript
    ================================================== -->

	<script src="js/app.js"></script>
</body>